---
layout: post
title:  "Fundamental Green Function to Poisson's function!"
date:   2016-02-09 17:00:46 -0500
categories: Green function
math: True
---
$$ {\scr D}(f)(s)=F(s)=\int_0^\infty f(t)e^{-st}\,dt. $$

Let's start today with a slightly new topic which is the first of the partial differential equations of physics, the famous partial differential equations for traditional physics and this is losse equation, and of course if you have a term on the right-hand side and this is a poisson equation. so the question we have in mind is a form of delta squared some function of r equal to some other given function like g, this is a Poisson's equation.

By the way, the operator delta square \[ \nabla^2 f(\vec{r}) \] itself appears in all these equations, all the standard equations we're gonna discuss, namely Poisson's equations, the wave equation, the diffusion equation, the Helmholtz equation, and so on. And there's a reason for it, of course, because delta square is a scaler operator. It is invariant under rotations, and these physical systems of a situation that we're going to describe will generally have a rotational invariance for some kind. So you have a second order differential operator delta square,  which is a scalar operator, has a lot of fantastic properties.  It's golden elliptic partial differential operator in the classification of such operators and it's absolutely fundamental. When you generalize this delta square to high-dimensional spaces, curve spaces, and other manifold spaces and so on,  it turns out,  but if you know a certain eigen value problem based on the delta square, very roughly speaking if you know its eigen functions and its eigen values spectrum then you can see a great deal about the underlying space itself. So very interesting fact that knowledge of the eigen value spectrum of the Laplacian operator and its generalizations, gives you a great deal of information about the underlying space itself, OK. I'll come back to this point. For the moment we will focus on Poisson's equation, the first of these equations. And the question is how do we solve such a linear partial differential equation you'd be given some function g(r). 

We will do this by a sort of combination of physical arguments and mathematics. Simply, all of you are familiar with this equation from the most classic example of all, namely electrostatics where you have delta square acting on the electrostatic potential, is equal to the charge density on the right hand side, apart from a constant. And we know for the solution to that is essentially Coulomb's law plus the superposition principle. That's the general solution.So we're going to exploit that fact and I will give a physical argument to see how you can extend the solutions of this equation to higher dimensions. But the purpose here is restricted, for all these partial differential equations, my primary aim is to find the so-called fundamental solution to this equation, namely the fundamental Green function for such a differential operator which will then help you write down the solution for the general in homogeneous equation. So we'd like to find the Green function for the delta square operator. Know what is the Green function just to recall to you since you must have already come across this in courses on differential equestions. The idea behind the Green function as the following. Let's start with the simplest example. We have a function f(x) and have 

some differential operator            , involves x, functions of x ,

derivatives with respect to x and so on. Acting on this f of x is equal to some other function g of x, a given function. and the question I asked is what's the solution to such an eqution, an inhomogeneous equation. The answer is of course, they do need to formally invert this operator and somehow get it act on this g here. So let's do this in abstract notation and see what it looks like. In abstract notation, if this

         
 is a representative of some operaters in some space, some lineaer space, and this f is represented by this,            , ket \[ \ket \] on the space, I'll use the notation here. this is equal to g on the right hand side.

This will imply, formally,  that the solution f is equal to         if it exists, acting on g, formerly of course. But that's not all, because you could also have a piece plus a piece which is some vector |hi>  where      acting on this |hi> equals to zero and in fact sum over linear combinations of all such eigen functions or eigen states such that if this opera acts on it, it annilates and equal to 0. So as you can see this is the solution to the homogeneous equation              operator acting on some matrix equals to 0. And this is the part of that comes from the in homogeneous equation. And in the language of differential equations this portion when you wrtie it back in function space, this portion is what you call the particular integral and the rest operator call the compliment to function. and of course we can write this back in the position space and see what happens, here but remember that the so-called f of x is nothing but their representative of this ket vector in the x basis if you like, it stands for that. Then what does this equation really look like, it says f of X equal to and there's some operator g acting on, D inverse acting on this g. and all we can ask when this is nicely done what is going to be. This is a differential operator of some kind so the inverse opeator's in general been integral operator in general.  so this woul be a form of an integral  of dx prime, some capital G of x, x prime, g of x prime, plus of course summation of ci hi of X, where these other representators in this X bases of these abstract vectors in function space. so this G here represents this D inverse. in fact we can make it even more precise,  G of x, x prime,  the so-called Green function for this differential operator, this thing here is nothing but x, D inverse, x prime.  its it's obvious from this notation but that's precisely what it is. I leave you to figure this out i mean it's very trivial. don't you want me to do this? put an X on either side so you get x, f, that's equal to f of x, that's equal to X, and then the D inverse, g,  plus summation over I,  ci, x, hi. this is what we've got hi of x so that's what this thing is and here now insert a complete set of states, integral of dx-prime, x-prime, x-prime. that's the identity operator, I inserted in between and then of course I get x d inverse x-prime that's a function of x and x-prime between G, the Green function, and integrated over dx-prime, and then x-prime acting on g that's g of x-prime. ok so this is all it is. Writing down this abstract notation is trivial, writing it down here is just one more step take the matrix element between x and x prime, and that's it.  (Some question), yes yeah we have to certainly worry about being exist so if it exists then this is true. so we'll have to ask what are the conditions under which these D inverse exists and what I'm going to do a little later when we talk about integral equations is to show you under what conditions you would have this members exist for this operator. for the moment we assume it exists anything. so this thing here is called the Green function of the differential operator Dx. it's nothing but the inverse of the operator expressed in this basis and we need now to find out what this is. but that's very simple we need an equation for this G that's not hard to find because notice that DD inverse must be equal to the identity operator and if I expressed this in the position basis what's going to happen? this thing here is represented by DX and this guy here is G of X comma X prime, and that's equal to the bra x with the ket of x-prime, which is nothing but delta x minus x prime. so solve this equation with the delta function on the right hand side and then you can solve this general equation by plugging that in here and in doing this in particular,  it gives you the particular Integral thing. so this in a sense is the Green function method. all you're doing is to invert some operator, writing it in some particular presentation and it satisfies this differential equation and engineers are used to calling this the unit impulse function of whatever it is. The super cool is all sets, corresponses to the unit impulse function multiplied by whatever you have that the given function and you have a solution.  

how does this work in practice well if you look at the very simple example let's look at, just to refresh your memory. let's look at an extremely simple example. Oh, first, one question I should ask. How much of this should you put this in? what decides that? yeah all the boundary conditions will decide what these coefficients are and what adds the mixture of the compliment to the functions to the particular integral.  as we will see a simple example, so let's do this example first and then come back the Poisson's equation. 

The example is a standard one. it starts with the self adjoint differential operator so it's on the form d2f over dx2, this is f of x,  equal to some given function g of x.  I'd like to solve this equation, it is the simplest of examples.  we need some boundary conditions and we need to see what's the range of acceptable x. let's say the unit interval let's say X is elemental 0 from 1.  and I need to put some boundary conditions on this f. so typically would say f of 0 equal to something, f of 1 equal to something other,  some constant some other Constant.  call this a, call this b. so subject to these boundary conditions the question is what's the solution to this differential equation, what is particular intetegral.  so let's say to find out what the Green function of this operators and the Green function satisfies d two G of  X over d x two, equal to a delta of x minus x prime. so what it says is that the second derivitive of this with respect to x is essentially zero except one x equal to x prime. so the big jump a delta function jump at x equals to x prime. so let's first saw it in the region X less than x'. then resolve it in the region X greater than x prime.  so 0 less than equal to x less than x prime. what's the solution to this equation well this is the zero.  so it says the second derivative of this G as a function of X with respect to x is zero, which means that D is just a linear function, right?  so this is equal to, this implies that G of x, x prime equal to some A1x plus A2. A1 and A2 could depend on x-prime in fact they would engender depend on x-prime cause we just integrated with respect to x along. and in the other region x-prime less than X less than equal to 1, G of x,x prime equal to some other constant A3x pulus A4. now we have four Constants to be determined to give us the full G and what are the pieces of information we have well the first piece is this okay so we put in the boundary conditions, I need to put in this boundary condition here too, and then there are two other pieces of information needed to determine what the constants are and what are those pieces of information?  well the first one is that continuity of G okay there is an asset that G is continuous is because its second derivative has a delta function jump so what does it mean for the first derivative. this is gotten infinite jump ultimate so what does it mean for the first derivative? it means the first derivative is a finite jump of some kind. Right? because if you integrate this equation if you integrate this equation with respect to X from some,  for a fixed x-prime said ex-prime minus epsilon to x-prime plus epsilon you integrate dx and you integrate this guy here then it says d two G over d x two, this is equal to dG over dX  at ex-prime plus epsilon minus  dG over dx  at ex-prime minus epsilon. immediately to the left of ex-prime and the right of ex-prime. I integrate in this small range may get this and what's this equel to, I integrate this across the point ex-prime in x. so what's the answer what happens if you had a delta function? you get one so this is equal to 1 so in a sense it says that the discontinuity of the first derivative of G at the point x prime is given to you so you need to use that information here. 16:12

I differentiate both sides with respect to x and, put ex-prime, X equal to x prime minus epsilon on the one hand plus epsilon on the other hand take the difference between the two. for the minus I take this and for the plus I take that. And it Equates at the x prime. so that gives you one more condition and what's the last condition of the all ?  this says the derivative of G has a fine a jump so what is G itself has to have? it has to be a cusp because it has to be something like this. because the slopes are different and there's a finite difference between the two slopes so the function g itself will look like this G prime look like this and G double prime have a delta function jump.

 and so whenever you have another function here in the second derivative you know immediately that the function itself will be continuous but the first derivative has known jump. so that fixes all the conditions the first one is fixed by F at zero then F at the other end at one then the continuity of G at the point ex-prime and give you one more condition between the four constants, for quantities A1, A2, A3 A4, and the finite jump here gives you one more condition so you can put those in and work out what A1 A2 A3 A4 are and and that's the Green function. you can do this for more general boundary conditions Since the more general condition will be f(0) plus some multiple of f prime of 0, f'(0) or something else and similarly for one. these would be mixed boundary conditions on both sides and again write down the Green function in the general case. 

so this gives you some idea of how you handle the Green function method. what we'd like to do is a slightly simpler a simpler problem in some sense we'd like to do it for higher dimensions setting,  partial differential operators but we'd like to use get the fundamental solution so in general the boundary condition and we are gonna take is going to be the Green function to be vanishing at infinity or something like that to we take all of the space and ask what happens the Green function vanishes at the infinity. so now let's go back and look at Poisson's equaiton. 

rewrite the solution done by guess work and then we take derivative more sensible considerations. so if you recall this equation phi of r is minus rho of r over epsilon o. 

if you recall what the solution to this equation is this person's equation electrostatics what's the solution to it is essentially columns law right 

the solution is phi of r  equal to an integral d three r prime, rho of r prime, over modulus r minus r prime, one over four pi epsilon.  that's the solutions columns law and then the superposition principle is used to add up the potentials of all the charges. all points were the charges.

  know what does that imply for the general equation well generally question was of the form. F of r ,  this was equal to some g of r.  

By analogy with this it's clear that the solution we looking at is f of r is minus one over four pi, g of r prime over this.  so the Green function in this problem for the delta square operator is nothing but minus one over four pi multiply r minus r prime. that's the Green function and we should get this we should be able to be derive this rigorously that this is indeed the Green function for the three-dimensional delta sqaure operator. 

satisfying the boundary condition that this solution by the way for Poisson's equation written down assuming that the potential vanishes at infinity so the boundary condition on this G is as r  goes to infinity this G vanishes. so this is the free Green function with natural boundary conditions. 
now let's see how to derive this so in start with this equation, and write the particular integral this implies that f of r is equal to and an integral d three r prime, G of r comma r prime little g of r prime, plus of course the complementary function. but I'm not interested in it at the moment I just want to know what the Green function is and what is equation  does this G satisfy? 
 it satisfies the same equation as here with the delta function on the right hand side so you have delta square g of r, r prime is equal to a delta function a three-dimensional delta function of r minus r prime. I need to solve this equation put the solution back in here and then that's it that's the particular integral . 
now just to remind myself that the derivative or delta squaret is with respect to r. Let me put an r here to show that it's an operator respect to the variable r, rather than r prime.  now I assert that this equation here implies immediately that this G is a function of r minus r prime, and not r alone.  and the reason I do that is because the right hand side is a function of r minus r prime. Delta square, delta it self,the derivative with respect to r is the same as the derivative with respect to r minus r prime. for every fixed r prime, it is just a shift.
Are these two statements enough to say that the solution will also be a function of only r minus r prime? are these enough? Delta square is invariant. so I if I put R equal to r minus r prime, then my statement is delta R square is the same as delta r square . It's just a shift so this guy could be delta capital R.
 this is delta three of capital  R vector. so can I now assert that this also is a function of capital R vector. can I do that in the think the example we looked at a little earlier d two f over d x two equal to right hand side was again a delta of x minus ex-prime for the second derivate operator. but that Green function did not turn out to be, although we work out fully, but it's not a function of x minus x prime.  why not? the d2 over dx2 was also d2 over d x minus x-prime the second derivative.  the delta of X minus ex-prime, the function of x minus prime and yet the Green function didn't turn out to be a function of x minus x prime. what happened ? Yeah finite boundaries.  the boundary condition broke this translation invariance. The boundary condition broke it, so you can't shift arbitrarily because it is a finite boudary. 
in this problem however we are asking for a solution,  at this vector goes to infinity, you're asking for something which goes to zero right so  r goes to infinity, r minus r prime also goes to infinity for fixed r prime. so in this problem with these natural boundary conditions the boundary conditions also translation invariant. the operators transmission invariant,  the inhomogeneous term translation invariant,  and so is the boundary condition so we can assert therefore that the solution is also translation invariant. 
 this will imply, now, that the equation we have to sovle, so we have to be careful therefore. so the equation we have to sovle is delta R sqaure  G of R equal to delta three of R. that's the equation we have to solve. what should we do? we should do something which converts this delta  square into a multiplication. and the obvious thing to do is to a Fourier transform immediately. so let's define a Fourier transform, G of R equal to, it's in three dimensions so it's one over two pi cube, d three k, e to the power I k dot R, G tilt of k. and of course there's an inverse relation this would also imply that G tilt of k equal to integrate d three R e to the minus I k dot R, G of R.  and let's put that in here. Let's substitue this representation for G in here and the delta R does not act on that and only act on this.  Now what does the delta square do on the scalar relating to the I k dot R. what does that do. It's just been done on an I K vector. All it does has been done on I k vector. This is a plane wave this guy is a presence of a plane wave with normal to the wave plane is the K direction. and the Delta always acts, he is always in the direction of the maximum rate of increase. This is I k.  

so what's delta square? Delta R this guy. so we gotta do the divergence of this but this is not dependent on R  and we get only the divergence, the gradients of this once again. so it says delta square is minus or whatever it is.  let's put that in right way. So it says one over two pi cube,integrate d three k, e to the I k dot R, minus K squared, G tilt of k, is equal to on the right hand side the delta function.
 but we can write that delta function itself in terms of this exponential,  right.  the delta function's Fourier Transform is  just one, so you can write this as one over two pi for cube, integrate d three k , e to I k dot R.
and this forms a complete set of states for all K integrated over K. it forms a complete set of states in the R space and you're equating these two variables. so component by component, they must be equal when equate two vectors, they equal to component by component. so the coefficient of each e to the I k dot R  on the two sides must be equal, which says minus k squared G tilt of k  must be equal to unity. so we've got G tilt of k, it's minus one over k squared. that's it. so immediately says that this solution 


so if I move this to the left hand side, it says this minus one is equal to zero. So it says a certain Vector, a certain function is zero. Identically. and when is a vector zero? When every component is zero. And  what is the unit vector in this problem. It's the e to the I k dot Rs in function space, the other unit vectors and for every K this quantity must be zero. that says G tilt of k is minus one over k square. so the argument is completely rigorous. but it has to go, you have to go through it the reason you can equate the Fourier equations is because these things form a complete set of states. and therefore you can bring everything to the left hand side and says a certain vector is 0 which means every component is zero. so each for the component must be zero. 

and therefore once I put that in here this is minus one over two pi for cube integral d three k e to the I k dot R over k square. That's G of R.  if I can evaluate that integral then I've got an expression for G of R and I put that back in the G of R comma R prime. And that's it. that gives me the fundamental Green function.  so let's see how to do this integral . 

what would you do to tackle such an integral. if you took an arbitrarily coordinate system, you're in deep trouble because this means k vector points somewhere you're going to integrate all the directions in k, the R vector points somewhere else you were going to integrate all the angle between the two, because the e to I k dot R, as e to the I modulus k modulus R, the cosine of the angle between them and that's a big nuisance.  it's a terrible nuisance. There is no way to integrate this at all if you want to do it the hard way because if you took two arbitrary vbectors, if you took some vector like this and some other vector like that, this is called some polar coordinates r , theta, phi, say, and this is called r prime, theta prime, phi prime, etc.  we're asking for the angle between these two guys,  the dyhedral angle between these two vectors. you can rewrite,you can write this angle, in terms of the polar coordinates a polar angles for each individual vector, right. it's called the law of sines or something interesting. It's standard problem in spherical geometry, I don't know that's learned by people. but if the coordinates here are theta, phi, and the polar coordinates here are theata prime, phi prime. And this angle is gamma then there's a relation which is essentially the additional theorem for the Legendre function of order one. (32:56)

 so it says something like welcome cost gamma equal to cost greater costed a prime plus sign painter signs that the Prime cost fine minus pipeline you have to put back in here and then integrated with a prime and fight crime which is a terrible top horrible so that's not the real dude you could ask and I dude in Cartesian coordinates well you could in general except that you have this factor sitting here otherwise this itself will you be a product so could do this in Cartesian coordinates but doing it with this case grazing in a big problem so what should we do mission we should clearly look at some in the audience up this quantity hit this year for it's a skill the fact that it's a skill that means it is invariant under rotations so you could actually to lose your coordinate system as you please you can to the polar axis of you coordinate system i do please and given any other toys you can bring it to this choice but tender variables in the case base know what's this what director speaking in that sticky note K's integrated over so what victor sticking out are Victor so let me to use the polar axis in k-space along the specter of good you can always do that so once they do that then the ball around love K is just crossed into there's just that they don't I need to the I can our dog becomes you do the eye care costed is that if I dependence not so I can integrate or fight and worth the integral of I give you user to buy so this immediately means but you can in case-based tools this access along the direction of are and then K is integrated or or directions but this angle is there to here and is the typical K so this integral becomes GOP are good to by the way I said that this function is this killer so I really expected not to depend on the direction of our either Richard fine and up depending on you on the magnitude of this are right so I could great deal capital are without the victor sign but will receive that really comes out on or so this is equal to minus wanna love to buy whole cue integral zero to infinity case grade BK but there's a case grand in the denominator which obligingly cancels out and then there's a talk by from the plane to go so this becomes a to buy squared never done the plaintive on the fight integral and then I have an integral over the theater pitches -21 be costly to KDDI K are cost a change ladybird accosted is running from -1 to 1 so this thing gives you either the I Kr mine is either the minus I kill over Ikea but the numerator stew I signed here so I get it up this invade missus two-way sign K car or tight K so this is for by squared let's make it a -1 over for by was a to so to by square to cancel the I cancels by the way the case great cancels BR comes out and you have BK Sankey are overtly so this is the paper -1 over to by way capital are into love you know to infinity being think key net but this is the Declan table capital out as positive so what's the value this integral by over two so this gives you so you have the call on potential back with the four plays in the science alone so in a sense what this does greatness telling you is that the the desk Wed why and the in a two-sided potential giving you the does tend to be on the right hand side this is not an accident columns lies directly a consequence to the fact that the operators does great so very often you've see this statement that the Green function for those great is just the call on potential in fact you could define the Cologne potential in Ann Arbor to number bill mentions as the inverse Fourier transform a 10 work is great are as the Green function fried green production of the desk white operative will do that very shortly but I wanted to see how this the 1 overall minus Outbrain model SS emerged King and rest up for the rest of course follows know you can rate F-four are between nine and 10 walked by printing PR I am you up were more government plus of course the compliment to function but I took the boundary condition that this went to zero to infinity and is the solution now of course you can't look at various special cases you could ask what happens if this is a function only of mining to if it's a taj density for example what happens if it's a spherically symmetrical charge density so depends only on the vector the magnitude of the vector our prime ansel all these cases can look and on a few I'm sure a familiar with the fact that this going to be here 10 more are minus our prime is called the call on Conan for obvious reasons and you normally when you do these multiple expansions you expand this guy in powers of our or our prime or something like that and what is that cities look like well there's a famous series which goes like summation an equal to zero to infinity if the angle between are in our prime to the angle are I'm people to gamma thing the anger between them some gamma then this expansion here says depends on mother daughter is bigger than our prime our art is less than our prime and expansion generally goes like this is equal to 1 over are the greater of the two and then our prime mover up to the power L and as a PA love costed post cap but if I want to write this and under the polar coordinates of of the on in our prime separately then I get this fake a harmonic expansion of the column gonna which again I'm sure is well known to you from electromagnetism you have to really like this 'cause gamma back in terms of costed a costly to prime plus signed they don't think that the Prime Minsiter and use the addition p.m. for the Legendre polynomials and this expansion would look something like summation I'm not sure about the factors but any border 0 infinity well this bar to be the same on greater are smaller or greater to a bar L and then they would be pieces which would look like there's also some Asian from pay me put in mind the third L that by: and them of paper by why in them start okay the prime by Prime ansel some such thing some to a plus one practice and so on depending on how this is normally these are the spherical harmonics so that's the multiple this gives you the multipole expansion in general for the circle on potential but this is true engendered for any one or more are minus are do the HMO do life low

